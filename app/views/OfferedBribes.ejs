<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome to Peer Assessment Tool</title>
    <style>
        .bribe-row {
            padding: 10px;
            border: 1px solid #ddd;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
          }
          .bribe-details {
            flex: 1;
          }
          .actions {
            display: flex;
            gap: 10px;
          }
          .accept-btn, .deny-btn {
            padding: 5px 10px;
            cursor: pointer;
          }
          .accept-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
          }
          .deny-btn {
            background-color: #f44336;
            color: white;
            border: none;
          }
    </style>
    <link rel="stylesheet" href="/MainPage.css" />
  </head>

  <body>
    <header>
      <h1>Bribing Center &#128520;</h1>
    </header>

    <main>
        <% if (bribes && bribes.length > 0) { %>
            <% bribes.forEach(bribe => { %>
              <div class="bribe-row">
                <div class="bribe-details">
                  <p><strong>STUDENT ID:</strong> <%= bribe.StudentID%></p>
                  <p><strong>AMOUNT:</strong> <%= bribe.BribeAmount %>$</p>
                  <p><strong>GRADE WANTED:</strong> <%= bribe.GradeWanted%></p>
                  <p><strong>COMMENTS:</strong> <%= bribe.Message %></p>
                </div>
                <div class="actions">
                  <button class="accept-btn" onclick="handleDecision('<%= bribe.id %>', 'accept')">Accept</button>
                  <button class="deny-btn" onclick="handleDecision('<%= bribe.id %>', 'deny')">Deny</button>
                </div>
              </div>
            <% }) %>
          <% } else { %>
            <p>No bribes available.</p>
          <% } %>
          
          <script>
            function handleDecision(bribeId, decision) {
              // Send decision to server via fetch API (or form submission)
              fetch(`/bribe/${bribeId}/${decision}`, {
                method: 'POST'
              })
              .then(response => response.json())
              .then(data => {
                if (data.success) {
                  alert(`Bribe ${decision}ed successfully`);
                  location.reload();  // reload page to update status
                } else {
                  alert("Failed to process the bribe");
                }
              })
              .catch(error => console.error("Error:", error));
            }
          </script>          
    </main>